---
title: A Stage-Based Population Model for Loggerhead Sea Turtles, after @crouse1987
author: "Tamora James"
date: "`r format(Sys.time(), '%d %B %Y')`"
output: html_document
bibliography: loggerhead.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, tidy.opts = list(comment = FALSE))
knitr::read_chunk("loggerhead.R")
```

```{r libs, include=FALSE}
```

This workbook follows the matrix population model methods and analyses outlined in @crouse1987 to produce equivalent analyses.

First, import the turtle data [@crouse1987, Table 3] and add a column for stage length, then set up the projection matrix using this data and equations 1 and 2 in @crouse1987.

```{r dataimport}
```

@crouse1987 calculate the eigenvalues and eigenvectors using the power
method. Here I'll use just use eigen() to get the eigenvalues and vectors.

```{r eigen, tidy=TRUE}
```

This gives $\lambda_m = `r round(Re(lambda), digits=4)`$ and $r = `r round(Re(r), digits=4)`$
which are pretty close to the values $\lambda_m = 0.9450$ and
$r = -0.0565$ generated by @crouse1987.

The stable stage distribution is given by the right eigenvector (coerced here
to its real part).

```{r ssd, tidy=TRUE}
```

```{r ssd-plot, echo=FALSE}
```

Most individuals belong to the eggs/hatchlings and small juvenile stages.

The reproductive value is given by the left eigenvector, which we get by
calculating the eigenvectors of the transpose of the projection matrix.

```{r repro-val, tidy=TRUE}
```

```{r ssd-repro-val, echo=FALSE}
```

The mean reproductive value can be calculated from the reproductive value and stable stage distribution.

```{r mean-repro, tidy=TRUE}
```

## Sensitivity analyses

First, determine the impact of reducing or increasing fecundity or stage-specific survival parameters, each taken separately, on the intrinsic rate of increase $r$.

```{r sensitivity, tidy=TRUE, warning=FALSE}
```

The first plot represents 50% reduction in fecundity or survivorship while the second plot represents a doubling in fecundity or elimination of mortality. The dotted lines in these plots indicate the baseline rate of increase.

```{r sens-plot, echo=FALSE}
```

```{r sens-plot-report, echo=FALSE}
grid.arrange(p1, p2, nrow=1)
```

### Sensitivity to age at first reproduction

```{r sens-age, tidy=TRUE}
```

```{r sens-age-plot, echo=FALSE}
```

## Elasticity analysis
Analytical derivation of elacticities i.e. proportional sensitivities for matrix entries.

```{r elas, tidy=TRUE}
```

```{r elas-plot, echo=FALSE}
```

### Elasticity to stage-specific survival and stage duration

#### Elasticity of $\lambda$ to stage-specific survival

```{r elas-vr-other, echo=FALSE}
```

```{r, echo=FALSE}
p1
```

This figure was obtained using calculations from @caswell2001.

**TODO: Calculate elasticity of $\lambda$ to stage duration.**

## Management scenarios

Determine the rate of population growth expected under the following management scenarios:

1. Immature survivorship (stages 2, 3, and 4) increased to 0.80.
2. Survival of large juvenile and subadults increased to 0.80, adult survival increased to 0.85.
3. First-year survival decreased to 0.33735, survival of large juvenile and subadults increased to 0.80, adult survival increased to 0.85.

```{r scenarios}
```

What increase in survival at stages 2, 3, 4, and 7, taken individually, is required to achieve
stability ($\lambda = 1$, $r = 0$)?

```{r stability, tidy=TRUE}
```

These results are slightly different to those of @crouse1987, probably due to using a different method of finding the stable point.

## References
